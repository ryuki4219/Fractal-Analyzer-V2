# 🧠 Fractal Analyzer V2 - AI画像補完システム# Fractal-Analyzer-V2



フラクタル次元解析とAI画像補完を組み合わせた高度な画像解析ツールです。フラクタル次元を用いた画像解析アプリケーション（Streamlit版）



## ✨ 主な機能## 📋 概要



### 🤖 AI画像補完このアプリケーションは、Box-Counting法を用いて画像のフラクタル次元を解析します。

- **RandomForest機械学習**: 低画質画像から高画質画像を予測また、機械学習による予測機能や解像度補正AI機能を搭載しています。

- **データ拡張**: 回転・反転により学習データを6倍に増強

- **精度評価**: モデルの性能をリアルタイム表示## 🚀 クイックスタート



### 📊 フラクタル次元解析### 方法1: バッチファイルで起動（推奨・最も簡単）

- **ボックスカウント法**: 画像の複雑さを定量化

- **閾値調整**: 手動設定または大津の二値化1. `起動.bat` をダブルクリック

- **異常検出**: 無効な結果を自動検出2. 自動的にブラウザが開きます

3. ブラウザで http://localhost:8501 にアクセス（自動で開かない場合）

### 📈 可視化機能

- **3D表面プロット**: フラクタル構造を立体的に表示### 方法2: コマンドラインから起動

- **空間占有率**: 黒/白ピクセルの分布を円グラフで表示

- **比較表示**: 低画質→AI補完→高画質の3段階比較```powershell

# 1. 必要なパッケージをインストール（初回のみ）

### 💾 結果の保存pip install -r requirements.txt

- **CSV出力**: 解析結果を表形式で保存

- **画像保存**: 補完画像をPNG形式で保存# 2. アプリを起動

- **グラフ保存**: ボックスカウント・3Dグラフを画像で保存streamlit run fractal_app.py

```

## 🚀 クイックスタート

その後、ブラウザで http://localhost:8501 を開いてください。

### 1. 環境構築

## 📦 必要な環境

```powershell

# 仮想環境の作成- Python 3.8以上（Python 3.13.5で動作確認済み）

python -m venv .venv- 必要なパッケージ: requirements.txt を参照



# 仮想環境の有効化## ✨ 主な機能

.\.venv\Scripts\Activate.ps1

### 基本機能

# 依存パッケージのインストール- **Box-Counting法によるフラクタル次元解析**

pip install -r requirements.txt- **二値化処理と空間占有率の計算**

```- **複数画像の一括解析とExcel出力**

- **機械学習による予測機能**

### 2. アプリの起動- **異常値の自動検知**



```powershell### 🤖 解像度補正AI機能

streamlit run fractal_app.py低解像度画像でも高解像度相当のフラクタル次元を推定する機能

```

#### 使い方

ブラウザが自動的に開き、`http://localhost:8501` でアプリが起動します。1. 高解像度画像を用意

2. サイドバー「学習データ生成モード」ON → アップロード

または、`起動.bat` をダブルクリックして起動できます。3. 20～100枚繰り返す

4. 「解像度補正モデルを学習」ボタンをクリック

## 📖 使い方5. 「解像度補正を有効化」ON

6. 低解像度画像をアップロード

### 基本的な流れ7. 補正結果を確認！



1. **画像のアップロード**### ⚡ パフォーマンス設定

   - 「低画質画像」: 解析対象の画像- **高速プレビューモード**: 計算量削減、素早く結果表示

   - 「高画質画像」(オプション): AI学習用の正解画像- **高精度解析モード**: 全計算実行、正確な結果出力



2. **設定調整** (サイドバー)## 📁 出力ファイル

   - データ拡張の有効/無効

   - 二値化方法の選択(手動/大津法)- `model_joblib.pkl`: 学習済みモデル

   - 閾値の調整(手動の場合)- `scaler_joblib.pkl`: スケーラ

- `classifier_joblib.pkl`: 分類器

3. **解析実行**- `results.xlsx`: 解析結果（複数画像処理時）

   - 自動的にAI補完とフラクタル解析が実行されます- `train_data.csv`: 学習データ

- `resolution_correction_model.pkl`: 解像度補正モデル

4. **結果の確認**- `resolution_correction_scaler.pkl`: 解像度補正スケーラ

   - フラクタル次元

   - ボックスカウントグラフ## 🔧 トラブルシューティング

   - 3D表面プロット

   - 空間占有率アプリが開けない、エラーが発生する場合は、[TROUBLESHOOTING.md](TROUBLESHOOTING.md) を参照してください。



5. **結果の保存**### よくある問題

   - CSV出力ボタンで解析結果を保存

   - 各種画像・グラフをダウンロード#### ブラウザが自動的に開かない

→ 手動で http://localhost:8501 にアクセスしてください

### 推奨設定

#### パッケージが見つからない

#### 初めて使う場合```powershell

- データ拡張: ✅ **有効**pip install --upgrade -r requirements.txt

- 二値化方法: ✅ **大津の二値化**```



#### 詳細に調整したい場合#### ポートが使用中

- データ拡張: ✅ 有効```powershell

- 二値化方法: ❌ 手動streamlit run fractal_app.py --server.port 8502

- 閾値: 画像に応じて調整 (通常 100-150)```



## 🔬 技術仕様## 📖 詳細ドキュメント



### アルゴリズム- [実装概要](IMPLEMENTATION_SUMMARY.md)

- [最適化ガイド](OPTIMIZATION_GUIDE.md)

#### AI画像補完- [クイックスタート最適化](QUICKSTART_OPTIMIZATION.md)

- **モデル**: RandomForestRegressor- [解像度補正AIガイド](RESOLUTION_AI_GUIDE.md)

  - 推定器数: 50- [新UI README](新UI_README.md)

  - 最大深度: 15- [README v2](README_v2.md)

  - ランダムシード: 42

- **データ分割**: Train 70% / Test 30%## 🧪 動作確認

- **データ拡張**: 回転(90°, 180°, 270°)、反転(水平・垂直)

テスト用アプリで基本動作を確認:

#### フラクタル次元計算```powershell

- **手法**: ボックスカウント法streamlit run test_streamlit.py

- **ボックスサイズ**: 2, 4, 8, 16, 32, 64, 128```

- **計算式**: 傾き = -log(count) / log(size)

- **妥当性チェック**: 0 < 次元 < 3## 💡 使用例



#### 異常検出1. **単一画像の解析**

- カウント数が全て0の場合   - 画像をアップロード

- カウント数が全て同じ値の場合   - 閾値とリサイズ設定を調整

- フラクタル次元が範囲外(< 0 または > 3)   - フラクタル次元と占有率を確認



### 依存パッケージ2. **複数画像の一括解析**

   - 複数の画像を選択してアップロード

```   - 自動的にExcelファイルに結果を保存

streamlit>=1.28.0      # Webアプリフレームワーク

numpy>=1.24.0          # 数値計算3. **学習モデルの活用**

pandas>=2.0.0          # データ操作   - 解析を繰り返すと自動的に学習データが蓄積

opencv-python>=4.8.0   # 画像処理   - 「学習を実行」で予測モデルを構築

scikit-learn>=1.3.0    # 機械学習   - 新しい画像で予測値と実測値を比較

matplotlib>=3.7.0      # グラフ描画

openpyxl>=3.1.0       # Excel出力## ⚠️ 注意事項

```

本プログラムはサンプル実装です。

## 📁 ファイル構成画像サイズ、特徴量、異常判定基準、モデル選定は用途に応じて調整してください。



```## 📝 ライセンス

Fractal-Analyzer-V2/

├── fractal_app.py      # メインアプリケーション（ライセンス情報を記載してください）

├── requirements.txt    # 依存パッケージリスト

├── README.md          # このファイル## 🤝 貢献

├── 起動.bat           # Windows起動スクリプト

└── .venv/             # 仮想環境 (自動生成)バグ報告や機能リクエストは Issue でお知らせください。

```

---

## 🎯 活用例

最終更新: 2025年10月6日

### 1. 画質改善の検証
低画質な画像がAIによってどの程度改善されるかを視覚的に確認できます。

### 2. フラクタル構造の分析
自然画像、人工物、テクスチャなどのフラクタル次元を定量化できます。

### 3. 研究データの収集
CSV出力機能により、大量の画像データから統計的な解析が可能です。

### 4. 教育・学習
フラクタル次元や機械学習の概念を視覚的に理解できます。

## ⚠️ 制限事項

### 学習データ
- 現在は1ペアの画像で学習
- より高精度には複数ペア(10枚以上)が推奨

### 計算速度
- 大きな画像(> 1000x1000)は処理に時間がかかる場合があります
- データ拡張を無効にすると高速化できます

### フラクタル次元
- 閾値の設定により結果が大きく変わります
- 複雑すぎる画像では正確な計算が困難な場合があります

## 🔧 トラブルシューティング

### アプリが起動しない
```powershell
# 依存パッケージを再インストール
pip install -r requirements.txt --force-reinstall
```

### グラフが文字化けする
- Windows環境では自動的に日本語フォント(MS Gothic等)が使用されます
- フォントがない場合は設定で変更可能です

### エラー: フラクタル次元の計算に失敗
- 閾値を調整してください
- 大津の二値化を試してください
- 画像のコントラストを確認してください

## 📝 更新履歴

### v2.0.0 (2025-10-17)
- ✨ データ拡張機能を追加
- ✨ 閾値調整UI(大津の二値化対応)
- ✨ 保存機能(CSV、画像、グラフ)
- ✨ 比較分析機能
- ✨ 異常検出機能
- ✨ 日本語フォント自動設定
- 🎨 UIを大幅改善
- 🐛 各種バグ修正

### v1.0.0 (2025-10-07)
- 🎉 初版リリース
- AI画像補完機能
- フラクタル次元解析
- 3D可視化

## 📄 ライセンス

MIT License

## 👤 作成者

神奈川工科大学

## 🙏 謝辞

このプロジェクトは以下のオープンソースライブラリを使用しています:
- Streamlit
- OpenCV
- scikit-learn
- matplotlib
- NumPy
- pandas
